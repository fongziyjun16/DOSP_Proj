(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L;b=a.SimpleTwitter=a.SimpleTwitter||{};c=b.UsernameToken=b.UsernameToken||{};d=b.FollowInfo=b.FollowInfo||{};e=b.TweetInfo=b.TweetInfo||{};f=b.FollowingNewTweetInfo=b.FollowingNewTweetInfo||{};g=b.AccountPageProcess=b.AccountPageProcess||{};h=b.MainPageProcess=b.MainPageProcess||{};i=a.SimpleTwitter_Templates=a.SimpleTwitter_Templates||{};j=a.SimpleTwitter_JsonDecoder=a.SimpleTwitter_JsonDecoder||{};k=a.SimpleTwitter_JsonEncoder=a.SimpleTwitter_JsonEncoder||{};l=a.WebSharper;m=l&&l.Concurrency;n=l&&l.Remoting;o=n&&n.AjaxRemotingProvider;p=a.JSON;q=l&&l.UI;r=q&&q.Var$1;s=q&&q.Templating;t=s&&s.Runtime;u=t&&t.Server;v=u&&u.ProviderBuilder;w=u&&u.Handler;x=u&&u.TemplateInstance;y=l&&l.Operators;z=a.console;A=l&&l.Arrays;B=l&&l.JavaScript;C=B&&B.Promise;D=l&&l.AspNetCore;E=D&&D.WebSocket;F=E&&E.Client;G=F&&F.WithEncoding;H=l&&l.Unchecked;I=q&&q.Client;J=I&&I.Templates;K=l&&l.ClientSideJson;L=K&&K.Provider;c.New=function(M,N){return{username:M,token:N};};d.New=function(M,N){return{username:M,follower:N};};e.New=function(M,N,O){return{creator:M,content:N,retweetID:O};};f.New=function(M,N,O,P){return{id:M,creator:N,content:O,retweetID:P};};g.formProcess$35$20=function(M){return function(N){var O;m.StartImmediate((O=null,m.Delay(function(){var P,Q;P=N.Vars.Hole("username").$1.Get();Q=N.Vars.Hole("password").$1.Get();return P.length>0&&Q.length>0?(new o.New()).Sync("SimpleTwitter:SimpleTwitter.RPCServer.SignUpProcess:1209569782",[P,Q])?(M.Set("Sign Up Success"),m.Zero()):(M.Set("Username has EXISTED"),m.Zero()):(M.Set("Username & Password are REQUIRED"),m.Zero());})),null);};};g.formProcess$13$20=function(M){return function(N){var O;m.StartImmediate((O=null,m.Delay(function(){var P,Q;P=N.Vars.Hole("username").$1.Get();Q=N.Vars.Hole("password").$1.Get();return P.length>0&&Q.length>0?m.Bind((new o.New()).Async("SimpleTwitter:SimpleTwitter.RPCServer.SignInProcess:770625658",[P,Q]),function(R){var S;S=p.parse(R);return a.String(new a.Boolean(S.loginSign))=="true"?(self.document.cookie="username="+P,self.document.cookie="token="+a.String(S.token),M.Set(P+" sign in"),self.location.href=self.location.href+"main",m.Zero()):(M.Set("Incorrect Username or Password"),m.Zero());}):(M.Set("Username & Password are REQUIRED"),m.Zero());})),null);};};g.formProcess=function(){var M,N,O,P,Q,R,S,T;M=r.Create$1("");return(N=(O=M.get_View(),(P=(Q=(R=new v.New$1(),(R.h.push(w.EventQ2(R.k,"signin",function(){return R.i;},function(U){var V;m.StartImmediate((V=null,m.Delay(function(){var W,X;W=U.Vars.Hole("username").$1.Get();X=U.Vars.Hole("password").$1.Get();return W.length>0&&X.length>0?m.Bind((new o.New()).Async("SimpleTwitter:SimpleTwitter.RPCServer.SignInProcess:770625658",[W,X]),function(Y){var Z;Z=p.parse(Y);return a.String(new a.Boolean(Z.loginSign))=="true"?(self.document.cookie="username="+W,self.document.cookie="token="+a.String(Z.token),M.Set(W+" sign in"),self.location.href=self.location.href+"main",m.Zero()):(M.Set("Incorrect Username or Password"),m.Zero());}):(M.Set("Username & Password are REQUIRED"),m.Zero());})),null);})),R)),(Q.h.push(w.EventQ2(Q.k,"signup",function(){return Q.i;},function(U){var V;m.StartImmediate((V=null,m.Delay(function(){var W,X;W=U.Vars.Hole("username").$1.Get();X=U.Vars.Hole("password").$1.Get();return W.length>0&&X.length>0?(new o.New()).Sync("SimpleTwitter:SimpleTwitter.RPCServer.SignUpProcess:1209569782",[W,X])?(M.Set("Sign Up Success"),m.Zero()):(M.Set("Username has EXISTED"),m.Zero()):(M.Set("Username & Password are REQUIRED"),m.Zero());})),null);})),Q)),(P.h.push({$:2,$0:"operationstate",$1:O}),P))),(S=w.CompleteHoles(N.k,N.h,[["username",0],["password",0]]),(T=new x.New(S[1],i.accountform(S[0])),N.i=T,T))).get_Doc();};h.Process$184$33=function(M,N){return function(){var O;m.StartImmediate((O=null,m.Delay(function(){var P;P=M("username");N.$0.Post({$:6,$0:P});return m.Zero();})),null);};};h.Process$176$33=function(M){return function(N){var O;m.StartImmediate((O=null,m.Delay(function(){var P;P=new a.String(N.Vars.Hole("hahstagname").$1.Get());return P.length>0?(M.$0.Post({$:5,$0:a.String(P)}),m.Zero()):m.Zero();})),null);};};h.Process$168$35=function(M){return function(N){var O;m.StartImmediate((O=null,m.Delay(function(){var P;P=new a.String(N.Vars.Hole("followingname").$1.Get());return P.length>0?(M.$0.Post({$:4,$0:a.String(P)}),m.Zero()):m.Zero();})),null);};};h.Process$155$21=function(M,N){return function(O){var P;m.StartImmediate((P=null,m.Delay(function(){var Q;Q=new a.String(O.Vars.Hole("retweetcontent").$1.Get());return Q.length>0?(N.$0.Post({$:3,$0:p.stringify(e.New(M("username"),a.String(Q),y.toInt(O.Vars.Hole("retweetid").$1.Get())))}),m.Zero()):m.Zero();})),null);};};h.Process$142$23=function(M,N){return function(O){var P;m.StartImmediate((P=null,m.Delay(function(){var Q;Q=new a.String(O.Vars.Hole("tweetcontent").$1.Get());return Q.length>0?(N.$0.Post({$:3,$0:p.stringify(e.New(M("username"),a.String(Q),-1))}),m.Zero()):m.Zero();})),null);};};h.Process$123$22=function(M,N,O,P){return function(Q){var R;m.StartImmediate((R=null,m.Delay(function(){var S;M();S=Q.Vars.Hole("following").$1.Get();return S.length>0?(O.$0.Post({$:2,$0:p.stringify(d.New(S,N("username")))}),Q.Vars.Hole("following").$1.Set(""),m.Zero()):(P(["followState","Follow Input has been REQUIRED"]),m.Zero());})),null);};};h.Process$110$20=function(M,N,O){return function(){var P;m.StartImmediate((P=null,m.Delay(function(){var Q;M();Q=c.New(N("username"),N("token"));z.log(O.$0);O.$0.Post({$:1,$0:p.stringify(Q)});return m.Zero();})),null);};};h.Process=function(M){var N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1;function _2(_8){var _9;_9=(new a.String(self.document.cookie)).split(";");return _8==="username"?A.get(_9,0).substring(A.get(_9,0).indexOf("=")+1):_8==="token"?A.get(_9,1).substring(A.get(_9,1).indexOf("=")+1):"";}function _3(){var _8;self.document.cookie="username=";self.document.cookie="token=";_8=new a.String(self.location.href);_8=new a.String(_8.substring(0,_8.lastIndexOf("/")));self.location.replace(a.String(_8));}function _4(){N.$0.Post({$:0,$0:p.stringify(c.New(_2("username"),_2("token")))});}function _5(_8,_9){self.document.getElementById(_8).innerHTML=_9;}function _6(_8,_9,_){var $,ba;$=self.document.getElementById(_8);if(_)$.innerHTML="";ba=self.document.createElement("li");ba.appendChild(self.document.createTextNode(_9));ba.setAttribute("class","list-group-item");$.appendChild(ba);}function _7(_8,_9){var _,$,ba;_6(_9,"",true);_=(new a.String(_8)).split("}{");z.log(_);for($=0,ba=_.length-1;$<=ba;$++)_6(_9,A.get(_,$),false);}N=null;C.OfAsync((O=null,m.Delay(function(){return G.ConnectStateful(function(_8){return p.stringify((k.j())(_8));},function(_8){return(j.j())(p.parse(_8));},M,function(){var _8;_8=null;return m.Delay(function(){return m.Return([0,function(_9){return function(_){var $;$=null;return m.Delay(function(){var ba;return _.$==0?(ba=_.$0,m.Combine(ba.$==1?H.Equals(ba.$0,false)?(_5("followState","Follow Fail. Following not exist or has been followed"),m.Zero()):(_5("followState","Follow Success"),m.Zero()):ba.$==2?(_6("realTimeTweetTable",ba.$0,false),m.Zero()):ba.$==3?(_7(ba.$0,"followingTweetTable"),m.Zero()):ba.$==4?(_7(ba.$0,"qryHashtagTweetTable"),m.Zero()):ba.$==5?(_7(ba.$0,"qryMentionTable"),m.Zero()):H.Equals(ba.$0,false)?(_3(),m.Zero()):m.Zero(),m.Delay(function(){return m.Return(_9+1);}))):_.$==3?(z.log("websocket close"),_3(),m.Return(_9)):_.$==1?(_3(),m.Return(_9)):(z.log("websocket open"),m.Return(_9));});};}]);});});}))).then(function(_8){N={$:1,$0:_8};});P=r.Create$1("");P.Set(_2("username"));return(Q=(R=(S=(T=(U=(V=(W=(X=(Y=P.get_View(),(Z=new v.New$1(),(Z.h.push({$:2,$0:"username",$1:Y}),Z))),(X.h.push(w.EventQ2(X.k,"logout",function(){return X.i;},function(){var _8;m.StartImmediate((_8=null,m.Delay(function(){var _9;_3();_9=c.New(_2("username"),_2("token"));z.log(N.$0);N.$0.Post({$:1,$0:p.stringify(_9)});return m.Zero();})),null);})),X)),(W.h.push(w.EventQ2(W.k,"tofollow",function(){return W.i;},function(_8){var _9;m.StartImmediate((_9=null,m.Delay(function(){var _;_4();_=_8.Vars.Hole("following").$1.Get();return _.length>0?(N.$0.Post({$:2,$0:p.stringify(d.New(_,_2("username")))}),_8.Vars.Hole("following").$1.Set(""),m.Zero()):(_5("followState","Follow Input has been REQUIRED"),m.Zero());})),null);})),W)),(V.h.push(w.EventQ2(V.k,"posttweet",function(){return V.i;},function(_8){var _9;m.StartImmediate((_9=null,m.Delay(function(){var _;_=new a.String(_8.Vars.Hole("tweetcontent").$1.Get());return _.length>0?(N.$0.Post({$:3,$0:p.stringify(e.New(_2("username"),a.String(_),-1))}),m.Zero()):m.Zero();})),null);})),V)),(U.h.push(w.EventQ2(U.k,"retweet",function(){return U.i;},function(_8){var _9;m.StartImmediate((_9=null,m.Delay(function(){var _;_=new a.String(_8.Vars.Hole("retweetcontent").$1.Get());return _.length>0?(N.$0.Post({$:3,$0:p.stringify(e.New(_2("username"),a.String(_),y.toInt(_8.Vars.Hole("retweetid").$1.Get())))}),m.Zero()):m.Zero();})),null);})),U)),(T.h.push(w.EventQ2(T.k,"qrytweetfromfollowing",function(){return T.i;},function(_8){var _9;m.StartImmediate((_9=null,m.Delay(function(){var _;_=new a.String(_8.Vars.Hole("followingname").$1.Get());return _.length>0?(N.$0.Post({$:4,$0:a.String(_)}),m.Zero()):m.Zero();})),null);})),T)),(S.h.push(w.EventQ2(S.k,"qrytweetfromhashtag",function(){return S.i;},function(_8){var _9;m.StartImmediate((_9=null,m.Delay(function(){var _;_=new a.String(_8.Vars.Hole("hahstagname").$1.Get());return _.length>0?(N.$0.Post({$:5,$0:a.String(_)}),m.Zero()):m.Zero();})),null);})),S)),(R.h.push(w.EventQ2(R.k,"qrytweetfrommention",function(){return R.i;},function(){var _8;m.StartImmediate((_8=null,m.Delay(function(){var _9;_9=_2("username");N.$0.Post({$:6,$0:_9});return m.Zero();})),null);})),R)),(_0=w.CompleteHoles(Q.k,Q.h,[["following",0],["tweetcontent",0],["retweetid",1],["retweetcontent",0],["followingname",0],["hahstagname",0]]),(_1=new x.New(_0[1],i.main(_0[0])),Q.i=_1,_1))).get_Doc();};i.accountform=function(M){J.LoadLocalTemplates("account");return M?J.NamedTemplate("account",{$:1,$0:"accountform"},M):void 0;};j.j=function(){return j._v?j._v:j._v=(L.DecodeUnion(void 0,{mentionTweet:5,hashtagTweet:4,followingTweet:3,followingNewTweet:2,followResult:1,value:0},[["LoginVerifyResult",[["$0","value",L.Id(),0]]],["FollowResult",[["$0","followResult",L.Id(),0]]],["FollowingNewTweet",[["$0","followingNewTweet",L.Id(),0]]],["QryFollowingNameTweet",[["$0","followingTweet",L.Id(),0]]],["QryHashtagTweet",[["$0","hashtagTweet",L.Id(),0]]],["QryMentionTweet",[["$0","mentionTweet",L.Id(),0]]]]))();};k.j=function(){return k._v?k._v:k._v=(L.EncodeUnion(void 0,{mention:6,hashtag:5,name:4,content:3,followInfo:2,logoutInfo:1,loginInfo:0},[["LoginVerify",[["$0","loginInfo",L.Id(),0]]],["Logout",[["$0","logoutInfo",L.Id(),0]]],["FollowOperation",[["$0","followInfo",L.Id(),0]]],["TweetContent",[["$0","content",L.Id(),0]]],["QryFollowingName",[["$0","name",L.Id(),0]]],["QryHashtag",[["$0","hashtag",L.Id(),0]]],["QryMention",[["$0","mention",L.Id(),0]]]]))();};i.main=function(M){J.LoadLocalTemplates("main");return M?J.NamedTemplate("main",{$:1,$0:"main"},M):void 0;};}(self));
